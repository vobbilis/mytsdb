Write performance instrumentation enabled
Creating TSDB server on address: 0.0.0.0:4317, HTTP port: 9090, Arrow port: 8819
[2025-12-06 13:03:45.498] [info] StorageImpl::init() - Starting initialization - PHASE 3 INSTRUMENTATION
[2025-12-06 13:03:45.498] [info] StorageImpl::init() - Initializing BlockManagement
[2025-12-06 13:03:45.498] [info] StorageImpl::init() - Creating ShardedIndex
[2025-12-06 13:03:45.498] [info] StorageImpl::init() - Creating ShardedWAL
[2025-12-06 13:03:45.499] [info] StorageImpl::init() - ShardedWAL created
[2025-12-06 13:03:45.499] [info] StorageImpl::init() - Starting WAL replay
[2025-12-06 13:03:47.495] [info] WAL replay completed successfully
[2025-12-06 13:03:47.495] [info] StorageImpl::init() - Initializing BlockManager
[2025-12-06 13:03:47.495] [info] StorageImpl::init() - Recovering blocks from disk
[2025-12-06 13:03:47.640] [info] StorageImpl::init() - Found 2894 blocks on disk
[2025-12-06 13:03:47.873] [info] StorageImpl::init() - Initializing CacheHierarchy
[2025-12-06 13:03:47.873] [info] StorageImpl::init() - L3 Parquet persistence callback wired
[2025-12-06 13:03:47.873] [info] StorageImpl::init() - Starting CacheHierarchy background processing
[2025-12-06 13:03:47.873] [info] StorageImpl::init() - Initializing compressors
CacheHierarchy::background_processing_loop - Started
CacheHierarchy::perform_maintenance - Starting
[2025-12-06 13:03:47.873] [info] StorageImpl::init() - Initializing BackgroundProcessor
CacheHierarchy::perform_maintenance - Checking promotions
CacheHierarchy::perform_maintenance - Checking L1->L2 demotions
CacheHierarchy::perform_maintenance - Checking L2->L3 demotions
CacheHierarchy::perform_maintenance - Completed
[2025-12-06 13:03:47.873] [info] StorageImpl::init() - Initializing BackgroundProcessor
[2025-12-06 13:03:47.874] [info] Background processor initialized
[2025-12-06 13:03:47.874] [info] StorageImpl::init() - Initializing PredictiveCache
[2025-12-06 13:03:47.874] [info] Predictive cache initialized
[2025-12-06 13:03:47.874] [info] StorageImpl::init() - Initialization complete
Prometheus HTTP server listening on port 9090
[2025-12-06 13:03:47.874] [info] MetricsService initialized
QueryService registered successfully
gRPC server listening on 0.0.0.0:4317
OTEL metrics endpoint: 0.0.0.0:4317
[Main] Initializing self-monitoring...
[Main] Background processor obtained successfully
[SelfMonitor] Starting self-monitoring thread...
[SelfMonitor] Thread started, will scrape every 15 seconds
[Main] Self-monitoring started
[2025-12-06 13:03:47.875] [info] DerivedMetricManager started
[Main] Derived Metric Manager started
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1765055027.876309 9015592 add_port.cc:83] Failed to add port to server: No address added out of total 1 resolved for '0.0.0.0:8819'
Failed to start Arrow Flight server: Unknown error: Server did not start properly
TSDB server running. Press Ctrl+C to stop.
[2025-12-06 13:03:50.609] [warning] [SLOW QUERY] Duration: 0.013292ms (Parse: 0.012417ms, Eval: 0.000875ms) Query: __name__=up 
[2025-12-06 13:03:50.609] [warning]   Stats: Total: 0.013ms (Index: 0.012ms, ID: 0.000ms, Access: 0.000ms, CacheGet: 0.000ms, ActiveLookup: 0.000ms, ActiveRead: 0.000ms, BlockLookup: 0.000ms, BlockRead: 0.000ms, LockWait: 0.000ms, Decomp: 0.000ms, Sort: 0.000ms, Pruning: 0.000ms), Samples: 0, Blocks: 0, RG(Total/Time/Tags/Read): 0/0/0/0, Bytes(Skip/Read): 0/0, Samples: 0, Blocks: 0, CacheHit: No
[2025-12-06 13:03:50.713] [warning] [SLOW QUERY] Duration: 0.0135ms (Parse: 0.01275ms, Eval: 0.00075ms) Query: __name__=up 
[2025-12-06 13:03:50.713] [warning]   Stats: Total: 0.013ms (Index: 0.013ms, ID: 0.000ms, Access: 0.000ms, CacheGet: 0.000ms, ActiveLookup: 0.000ms, ActiveRead: 0.000ms, BlockLookup: 0.000ms, BlockRead: 0.000ms, LockWait: 0.000ms, Decomp: 0.000ms, Sort: 0.000ms, Pruning: 0.000ms), Samples: 0, Blocks: 0, RG(Total/Time/Tags/Read): 0/0/0/0, Bytes(Skip/Read): 0/0, Samples: 0, Blocks: 0, CacheHit: No
CacheHierarchy::perform_maintenance - Starting
CacheHierarchy::perform_maintenance - Checking promotions
CacheHierarchy::perform_maintenance - Checking L1->L2 demotions
CacheHierarchy::perform_maintenance - Checking L2->L3 demotions
CacheHierarchy::perform_maintenance - Completed
CacheHierarchy::perform_maintenance - Starting
CacheHierarchy::perform_maintenance - Checking promotions
CacheHierarchy::perform_maintenance - Checking L1->L2 demotions
CacheHierarchy::perform_maintenance - Checking L2->L3 demotions
CacheHierarchy::perform_maintenance - Completed
[SelfMonitor] Iteration 1: Submitting scrape task...
[SelfMonitor] Executing scrape task (iteration 1)
[SelfMonitor] ScrapeAndWrite called
[SelfMonitor] Query count: 2, Storage writes: 0
[SelfMonitor] Writing 58 metric series to storage...
[SelfMonitor] Successfully wrote 58/58 metrics
[SelfMonitor] Scrape task completed (iteration 1)
CacheHierarchy::perform_maintenance - Starting
CacheHierarchy::perform_maintenance - Checking promotions
CacheHierarchy::perform_maintenance - Checking L1->L2 demotions
CacheHierarchy::perform_maintenance - Checking L2->L3 demotions
CacheHierarchy::perform_maintenance - Completed
CacheHierarchy::perform_maintenance - Starting
CacheHierarchy::perform_maintenance - Checking promotions
CacheHierarchy::perform_maintenance - Checking L1->L2 demotions
CacheHierarchy::perform_maintenance - Checking L2->L3 demotions
CacheHierarchy::perform_maintenance - Completed
CacheHierarchy::perform_maintenance - Starting
CacheHierarchy::perform_maintenance - Checking promotions
CacheHierarchy::perform_maintenance - Checking L1->L2 demotions
CacheHierarchy::perform_maintenance - Checking L2->L3 demotions
CacheHierarchy::perform_maintenance - Completed
[SelfMonitor] Iteration 2: Submitting scrape task...
[SelfMonitor] Executing scrape task (iteration 2)
[SelfMonitor] ScrapeAndWrite called
[SelfMonitor] Query count: 2, Storage writes: 0
[SelfMonitor] Writing 58 metric series to storage...
[SelfMonitor] Successfully wrote 58/58 metrics
[SelfMonitor] Scrape task completed (iteration 2)
CacheHierarchy::perform_maintenance - Starting
CacheHierarchy::perform_maintenance - Checking promotions
CacheHierarchy::perform_maintenance - Checking L1->L2 demotions
CacheHierarchy::perform_maintenance - Checking L2->L3 demotions
CacheHierarchy::perform_maintenance - Completed
CacheHierarchy::perform_maintenance - Starting
CacheHierarchy::perform_maintenance - Checking promotions
CacheHierarchy::perform_maintenance - Checking L1->L2 demotions
CacheHierarchy::perform_maintenance - Checking L2->L3 demotions
CacheHierarchy::perform_maintenance - Completed
CacheHierarchy::perform_maintenance - Starting
CacheHierarchy::perform_maintenance - Checking promotions
CacheHierarchy::perform_maintenance - Checking L1->L2 demotions
CacheHierarchy::perform_maintenance - Checking L2->L3 demotions
CacheHierarchy::perform_maintenance - Completed
[SelfMonitor] Iteration 3: Submitting scrape task...
[SelfMonitor] Executing scrape task (iteration 3)
[SelfMonitor] ScrapeAndWrite called
[SelfMonitor] Query count: 2, Storage writes: 0
[SelfMonitor] Writing 58 metric series to storage...
[SelfMonitor] Successfully wrote 58/58 metrics
[SelfMonitor] Scrape task completed (iteration 3)
CacheHierarchy::perform_maintenance - Starting
CacheHierarchy::perform_maintenance - Checking promotions
CacheHierarchy::perform_maintenance - Checking L1->L2 demotions
CacheHierarchy::perform_maintenance - Checking L2->L3 demotions
CacheHierarchy::perform_maintenance - Completed
CacheHierarchy::perform_maintenance - Starting
CacheHierarchy::perform_maintenance - Checking promotions
CacheHierarchy::perform_maintenance - Checking L1->L2 demotions
CacheHierarchy::perform_maintenance - Checking L2->L3 demotions
CacheHierarchy::perform_maintenance - Completed
CacheHierarchy::perform_maintenance - Starting
CacheHierarchy::perform_maintenance - Checking promotions
CacheHierarchy::perform_maintenance - Checking L1->L2 demotions
CacheHierarchy::perform_maintenance - Checking L2->L3 demotions
CacheHierarchy::perform_maintenance - Completed
[SelfMonitor] Iteration 4: Submitting scrape task...
[SelfMonitor] Executing scrape task (iteration 4)
[SelfMonitor] ScrapeAndWrite called
[SelfMonitor] Query count: 2, Storage writes: 0
[SelfMonitor] Writing 58 metric series to storage...
[SelfMonitor] Successfully wrote 58/58 metrics
[SelfMonitor] Scrape task completed (iteration 4)
CacheHierarchy::perform_maintenance - Starting
CacheHierarchy::perform_maintenance - Checking promotions
CacheHierarchy::perform_maintenance - Checking L1->L2 demotions
CacheHierarchy::perform_maintenance - Checking L2->L3 demotions
CacheHierarchy::perform_maintenance - Completed
CacheHierarchy::perform_maintenance - Starting
CacheHierarchy::perform_maintenance - Checking promotions
CacheHierarchy::perform_maintenance - Checking L1->L2 demotions
CacheHierarchy::perform_maintenance - Checking L2->L3 demotions
CacheHierarchy::perform_maintenance - Completed
CacheHierarchy::perform_maintenance - Starting
CacheHierarchy::perform_maintenance - Checking promotions
CacheHierarchy::perform_maintenance - Checking L1->L2 demotions
CacheHierarchy::perform_maintenance - Checking L2->L3 demotions
CacheHierarchy::perform_maintenance - Completed
[SelfMonitor] Iteration 5: Submitting scrape task...
[SelfMonitor] Executing scrape task (iteration 5)
[SelfMonitor] ScrapeAndWrite called
[SelfMonitor] Query count: 2, Storage writes: 0
[SelfMonitor] Writing 58 metric series to storage...
[SelfMonitor] Successfully wrote 58/58 metrics
[SelfMonitor] Scrape task completed (iteration 5)
CacheHierarchy::perform_maintenance - Starting
CacheHierarchy::perform_maintenance - Checking promotions
CacheHierarchy::perform_maintenance - Checking L1->L2 demotions
CacheHierarchy::perform_maintenance - Checking L2->L3 demotions
CacheHierarchy::perform_maintenance - Completed
CacheHierarchy::perform_maintenance - Starting
CacheHierarchy::perform_maintenance - Checking promotions
CacheHierarchy::perform_maintenance - Checking L1->L2 demotions
CacheHierarchy::perform_maintenance - Checking L2->L3 demotions
CacheHierarchy::perform_maintenance - Completed
Received signal 15, shutting down...

=== Write Performance Summary ===
Total Writes: 290 (New: 14, Update: 276)
Total Time: 1.54 ms
Avg Time per Write: 5.32 us

--- Component Breakdown (Avg per Write) ---
WAL Write                :     2.46 us (46.34%)
Series ID Calc           :     0.68 us (12.71%)
Map Insert (Lock)        :     0.22 us ( 4.12%)
Index Insert             :     0.11 us ( 2.05%)
Series Creation          :     0.01 us ( 0.19%)
Sample Append            :     1.03 us (19.38%)
Block Seal               :     0.00 us ( 0.00%)
Block Persist            :     0.00 us ( 0.00%)
Cache Update             :     0.57 us (10.77%)
Mutex Wait               :     0.00 us ( 0.00%)

--- OTEL/gRPC Overhead (Avg per Write) ---
gRPC Handling            :     0.00 us ( 0.00%)
OTEL Conversion          :     0.00 us ( 0.00%)

--- OTEL Conversion Breakdown (Avg per Write) ---
  Resource Processing    :     0.00 us ( 0.00%)
  Scope Processing       :     0.00 us ( 0.00%)
  Metric Processing      :     0.00 us ( 0.00%)
  Label Conversion       :     0.00 us ( 0.00%)
  Point Conversion       :     0.00 us ( 0.00%)
=================================

Stopping derived metric manager...
[2025-12-06 13:05:12.187] [info] DerivedMetricManager stopped
Stopping self-monitor...
[SelfMonitor] Stopping...
Stopping HTTP server...
Shutting down gRPC server...
CacheHierarchy::perform_maintenance - Starting
CacheHierarchy::perform_maintenance - Checking promotions
CacheHierarchy::perform_maintenance - Checking L1->L2 demotions
CacheHierarchy::perform_maintenance - Checking L2->L3 demotions
CacheHierarchy::perform_maintenance - Completed
Shutting down Arrow Flight server...
