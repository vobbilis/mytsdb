Write performance instrumentation enabled
Creating TSDB server on address: 0.0.0.0:4317, HTTP port: 9090, Arrow port: 8815
[2025-12-06 12:37:34.553] [info] StorageImpl::init() - Starting initialization - PHASE 3 INSTRUMENTATION
[2025-12-06 12:37:34.553] [info] StorageImpl::init() - Initializing BlockManagement
[2025-12-06 12:37:34.553] [info] StorageImpl::init() - Creating ShardedIndex
[2025-12-06 12:37:34.553] [info] StorageImpl::init() - Creating ShardedWAL
[2025-12-06 12:37:34.555] [info] StorageImpl::init() - ShardedWAL created
[2025-12-06 12:37:34.555] [info] StorageImpl::init() - Starting WAL replay
Received signal 2, shutting down...
[2025-12-06 12:38:05.092] [info] WAL replay completed successfully
[2025-12-06 12:38:05.092] [info] StorageImpl::init() - Initializing BlockManager
[2025-12-06 12:38:05.092] [info] StorageImpl::init() - Recovering blocks from disk
[2025-12-06 12:38:10.935] [info] StorageImpl::init() - Found 37310 blocks on disk
[2025-12-06 12:38:26.237] [info] StorageImpl::init() - Initializing CacheHierarchy
[2025-12-06 12:38:26.237] [info] StorageImpl::init() - L3 Parquet persistence callback wired
[2025-12-06 12:38:26.237] [info] StorageImpl::init() - Starting CacheHierarchy background processing
[2025-12-06 12:38:26.237] [info] StorageImpl::init() - Initializing compressors
[2025-12-06 12:38:26.237] [info] StorageImpl::init() - Initializing BackgroundProcessor
CacheHierarchy::background_processing_loop - Started
CacheHierarchy::perform_maintenance - Starting
CacheHierarchy::perform_maintenance - Checking promotions
CacheHierarchy::perform_maintenance - Checking L1->L2 demotions
CacheHierarchy::perform_maintenance - Checking L2->L3 demotions
CacheHierarchy::perform_maintenance - Completed
[2025-12-06 12:38:26.237] [info] StorageImpl::init() - Initializing BackgroundProcessor
[2025-12-06 12:38:26.239] [info] Background processor initialized
[2025-12-06 12:38:26.239] [info] StorageImpl::init() - Initializing PredictiveCache
[2025-12-06 12:38:26.239] [info] Predictive cache initialized
[2025-12-06 12:38:26.239] [info] StorageImpl::init() - Initialization complete
Prometheus HTTP server listening on port 9090
[2025-12-06 12:38:26.239] [info] MetricsService initialized
QueryService registered successfully
gRPC server listening on 0.0.0.0:4317
OTEL metrics endpoint: 0.0.0.0:4317
[Main] Initializing self-monitoring...
[Main] Background processor obtained successfully
[SelfMonitor] Starting self-monitoring thread...
[SelfMonitor] Thread started, will scrape every 15 seconds
[Main] Self-monitoring started
[2025-12-06 12:38:26.240] [info] DerivedMetricManager started
[Main] Derived Metric Manager started
[2025-12-06 12:38:26.241] [info] Arrow Flight server listening on port 8815
Arrow Flight server listening on port 8815
TSDB server running. Press Ctrl+C to stop.
Write Performance Summary: No writes recorded.
Stopping derived metric manager...
[2025-12-06 12:38:27.245] [info] DerivedMetricManager stopped
Stopping self-monitor...
[SelfMonitor] Stopping...
Stopping HTTP server...
Shutting down gRPC server...
CacheHierarchy::perform_maintenance - Starting
CacheHierarchy::perform_maintenance - Checking promotions
CacheHierarchy::perform_maintenance - Checking L1->L2 demotions
CacheHierarchy::perform_maintenance - Checking L2->L3 demotions
CacheHierarchy::perform_maintenance - Completed
Shutting down Arrow Flight server...
[2025-12-06 12:38:32.347] [info] StorageImpl::close - Flushing pending data.
[2025-12-06 12:38:32.347] [info] StorageImpl::flush_nolock - Starting
CacheHierarchy::perform_maintenance - Starting
CacheHierarchy::perform_maintenance - Checking promotions
CacheHierarchy::perform_maintenance - Checking L1->L2 demotions
CacheHierarchy::perform_maintenance - Checking L2->L3 demotions
CacheHierarchy::perform_maintenance - Completed
[SelfMonitor] Thread exiting
CacheHierarchy::perform_maintenance - Starting
CacheHierarchy::perform_maintenance - Checking promotions
CacheHierarchy::perform_maintenance - Checking L1->L2 demotions
CacheHierarchy::perform_maintenance - Checking L2->L3 demotions
CacheHierarchy::perform_maintenance - Completed
CacheHierarchy::perform_maintenance - Starting
CacheHierarchy::perform_maintenance - Checking promotions
CacheHierarchy::perform_maintenance - Checking L1->L2 demotions
CacheHierarchy::perform_maintenance - Checking L2->L3 demotions
CacheHierarchy::perform_maintenance - Completed
[2025-12-06 12:38:48.874] [info] StorageImpl::flush_nolock - Processed 36851 series
[2025-12-06 12:38:48.874] [info] StorageImpl::flush_nolock - Flushing BlockManager
[2025-12-06 12:38:48.874] [info] StorageImpl::flush_nolock - BlockManager flush result: OK
[2025-12-06 12:38:48.874] [info] StorageImpl::close - Stopping cache hierarchy background processing.
CacheHierarchy::background_processing_loop - Stopped
[2025-12-06 12:38:48.896] [info] StorageImpl::close - Cache hierarchy background processing stopped.
[2025-12-06 12:38:48.896] [info] StorageImpl::close - Shutting down background processor.
[2025-12-06 12:38:48.907] [info] StorageImpl::close - Background processor shut down.
[2025-12-06 12:38:48.907] [info] StorageImpl::close - Finalizing current block.
[2025-12-06 12:38:48.907] [info] StorageImpl::close - Persisting all active series blocks.
[2025-12-06 12:38:48.910] [info] StorageImpl::close - Clearing data structures.
Write Performance Summary: No writes recorded.
[2025-12-06 12:38:50.038] [info] StorageImpl::close - Completed successfully.
TSDB server stopped
